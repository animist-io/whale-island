<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

# getPin

[lib/handlers.js:58-61](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L58-L61 "Source code on GitHub")

Generates a new 'pin' value. A signed copy of the pin is required to access server
endpoints that execute transactions on the blockchain or request account-specific data from it.
Pin signing verifies that the mobile client connecting to whale-island controls the private key for
the transacting account. Pin is valid while the connection is open. Connection will automatically
close if client does not make a request to one of the pin enabled endpoints within
config.PIN_RESET_INTERVAL ms. This token also mitigates an MITM attack vector for state-changing
transactions, where someone could sniff the encrypted packet and try to resend it.

**Properties**

-   `Read` **Characteristic** C40C94B3-D9FF-45A0-9A37-032D72E423A9
-   `Access` **Public** 
-   `Encrypted` **No** 
-   `Response` **Pin** 32 character alpha-numeric string

# getDeviceAccount

[lib/handlers.js:71-75](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L71-L75 "Source code on GitHub")

Publishes node's public account number.

**Properties**

-   `Read` **Characteristic** 1FD26CCA-EA2B-4B9E-A59E-17AA7E61A0AC
-   `Response` **Address** Hex prefixed string
-   `Access` **Public** 
-   `Encrypted` **No** 

# getBlockNumber

[lib/handlers.js:85-89](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L85-L89 "Source code on GitHub")

Publishes current blockNumber.

**Properties**

-   `Read` **Characteristic** C888866C-3499-4B80-B145-E1A61620F885
-   `Response` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** `"152..2"`
-   `Access` **Public** 
-   `Encrypted` **No** 

# getPgpKeyId

[lib/handlers.js:99-103](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L99-L103 "Source code on GitHub")

Publishes a PGP keyID that can be used to fetch the nodes public PGP key from '<https://pgp.mit.edu'>.

**Properties**

-   `Read` **Characteristic** 75C06966-FEF2-4B23-A5AE-60BA8A5C622C
-   `Response` **KeyID** : `"32e6aa. . .4f922"`
-   `Access` **Public** 
-   `Encrypted` **No** 

# getTxStatus

[lib/handlers.js:118-129](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L118-L129 "Source code on GitHub")

Responds w/ small subset of web3 data about a transaction. Useful for determining whether
or not a transaction has been mined. (blockNumber field of response will be null if tx is
pending)

**Properties**

-   `Subscribe` **Characteristic** 03796948-4475-4E6F-812E-18807B28A84A
-   `Request` **Hash** Hex prefixed tx hash
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** `{ blockNumber: "150..1", nonce: "77", gas: "314..3" }`
-   `Publishes` **[Null](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null)** if tx not found
-   `Access` **Public** 
-   `Encrypted` **No** 

# getAccountBalance

[lib/handlers.js:141-151](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L141-L151 "Source code on GitHub")

Responds w/ wei balance of requested account.

**Properties**

-   `Subscribe` **Characteristic** A85B7044-F1C5-43AD-873A-CF923B6D62E7
-   `Request` **Address** hex prefixed address to get the balance of
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** `wei` value translatable to BN. Will be `'0'` if address DNE
-   `Access` **Public** 
-   `Encrypted` **No** 

# getPresenceReceipt

[lib/handlers.js:168-179](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L168-L179 "Source code on GitHub")

Returns data that can be used to authenticate client's proximity to the node.
Response includes a timestamp, the timestamp signed by the node account, and the caller's
address signed by the node account (using web3.sign). Useful if you wish implement your own
presence verification strategy in contract code and can run an ethereum light-client on your
client's device, or have a server that can independently validate this data.

**Properties**

-   `Subscribe` **Characteristic** BA2C3091-DAB8-4D51-BF92-3A6F023E9AD7
-   `Request` **Pin** signed by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** `{time: '1453..9', signedTime: '0xaf..9e', signedAddress: '0x32..ae'}`
-   `Publishes` **[Null](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null)** if valid client address unrecoverable from pin signature
-   `Access` **Pin** signed by caller account.
-   `Encrypted` **No** 

# getClientTxStatus

[lib/handlers.js:196-215](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L196-L215 "Source code on GitHub")

Returns status data about both of the transactions that are executed in a verifyPresenceAndSendTx
request. (Whale-island waits for the presence verification request to mined before it sends the
client transaction - this endpoint provides a way of retrieving it) Response includes info about
the presence verification tx which may be 'pending' or 'failed', the presence verification tx hash
(verifyPresenceTxHash) and the client's sent tx hash (clientTxHash), if available.

**Properties**

-   `Subscribe` **Characteristic** 421522D1-C7EE-494C-A1E4-029BBE644E8D
-   `Request` **Pin** signed by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** `{verifyPresenceStatus: "success", verifyPresenceTxHash: "0x7d..3", clientTxHash: "0x32..e" }`
-   `Publishes` **[Null](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/null)** if client tx not found
-   `Access` **Pin** required
-   `Encrypted` **No** 

# getContractAddress

[lib/handlers.js:230-242](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L230-L242 "Source code on GitHub")

Returns `address` of the contract which requested presence verification services for the mobile
client at this node. Caller can use this to fetch contract code from their own Ethereum light
client or from a public Ethereum node like Infura and then generate signed rawTransactions and
publish them via whale-island (or elsewhere).

**Properties**

-   `Subscribe` **Characteristic** 007A62CC-068F-4E85-898E-7EA98AD4E31B
-   `signed` **Pin** by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **Address** `0x4f3e..a1`
-   `Access` **Pin** required
-   `Encrypted` **No** 

# getContract

[lib/handlers.js:258-275](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L258-L275 "Source code on GitHub")

Returns `code` and `address` of the contract which requested presence verification services for
the mobile client at this node. Caller can use this to generate signed rawTransactions and
publish them via whale-island (or elsewhere). This is a lot of data so it gets sent in a series
of packets. onGetContractIndicate handler publishes these as the client signals it can accept
more.)

**Properties**

-   `Subscribe` **Characteristic** BFA15C55-ED8F-47B4-BD6A-31280E98C7BA
-   `Request` **Pin** signed by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** address & code `{contractAddress: "0x4f3e..a1" code: "0x5d3e..11"}`
-   `Access` **Pin** required
-   `Encrypted` **No** 

# callTx

[lib/handlers.js:309-319](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L309-L319 "Source code on GitHub")

Executes web3.eth.call on public constant contract methods that use no gas and do not need to be signed.
This endpoint is useful if you wish to retrieve data 'synchronously' from a contract.

**Properties**

-   `Subscribe` **Characteristic** 4506C117-0A27-4D90-94A1-08BB81B0738F
-   `Request` **[Array](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array)** "to" and "data" fields of web3.eth.call param: `["0x84..e", "0x453e..f"]`
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** web3.eth.call return value
-   `Access` **Public** 
-   `Encrypted` **No** 

# sendTx

[lib/handlers.js:333-356](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L333-L356 "Source code on GitHub")

Sends tx as rawTransaction. Will not submit if a pending verifyPresenceAndSend request exists
in the contractDB for this caller account. (This endpoint is intended primarily as a convenience
for processing arbitrary method calls including contract deployments and payments.)

**Properties**

-   `Subscribe` **Characteristic** 3340BC2C-70AE-4E7A-BE24-8B2ED8E3ED06
-   `Request` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** signed pin & signed method call `{pin: {v: r: s: }, tx: "0x123d.."}`
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **Hash** transaction hash of method call returned by web3.sendRawTransaction
-   `Access` **Pin** 
-   `Encrypted` **Yes** 

# verifyPresence

[lib/handlers.js:370-385](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L370-L385 "Source code on GitHub")

Authenticates client's proximity to node by invoking their contract's "verifyPresence"
method with the node account.

**Properties**

-   `Subscribe` **Characteristic** 297E3B0A-F353-4531-9D44-3686CC8C4036
-   `Request` **Pin** signed by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **Hash** verifyPresence method call tx hash returned by web3
-   `Access` **Pin** required
-   `Encrypted` **Yes** 

# verifyPresenceAndSendTx

[lib/handlers.js:399-421](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L399-L421 "Source code on GitHub")

Authenticates client's proximity to node by invoking their contract's "verifyPresence"
method with the node account. Waits for verifyPresence tx to be mined and sends clients raw transaction.
This endpoint provides a way of authenticating and sending a transaction in a single step.

**Properties**

-   `Subscribe` **Characteristic** 8D8577B9-E2F0-4750-BB82-421750D9BF86
-   `Request` **[Object](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object)** signed pin & signed method call: `{ pin: {v: r: s:}, tx: "0x32a..2d" }`
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **Hash** tx hash of verifyPresence method call `0xa7873..de`
-   `Access` **Pin** required.
-   `Encrypted` **Yes** 

# messagePublication

[lib/handlers.js:433-452](https://github.com/animist-io/whale-island/blob/825fe590ce498a769d76328d8bb1384e84d96752/lib/handlers.js#L433-L452 "Source code on GitHub")

Generic request handler for message publications commisioned by contract.

**Properties**

-   `Subscribe` **Characteristic** contract defined v4 uuid
-   `signed` **Pin** by mobile client account
-   `Response` **Hex** `0x00` on success or [err](#hex-response-codes)
-   `Publishes` **[String](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String)** contract defined message
-   `Access` **Pin** required
-   `Encrypted` **No** 
